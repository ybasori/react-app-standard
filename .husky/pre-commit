#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"


# Stash unstaged changes
git stash --keep-index

# Run ESLint on staged files
npx eslint --fix --quiet -- "$(git diff --cached --name-only)"

# Check ESLint exit status
eslint_exit_status=$?

# Pop stashed changes only if ESLint ran successfully
if [ $eslint_exit_status -eq 0 ]; then
  git stash pop
else
  echo "ESLint found errors. Stashed changes were not popped."
fi

# Exit with the ESLint exit status
exit $eslint_exit_status